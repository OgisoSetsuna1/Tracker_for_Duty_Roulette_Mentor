# FF14 导随记录器本地版（Tracker for Duty Roulette: Mentor）

这是一个为《最终幻想 14》国服玩家设计的本地记录管理工具，用于记录和分析「随机任务：指导者任务」（下简称「导随」）的完成情况。项目使用 Flask 构建后端服务，配合前端页面实现数据录入、查询、统计与导入导出功能。

## 项目结构

```
├── app.py                   # Flask 应用主入口
├── .gitignore               
├── data/                    # 数据定义文件夹
│   ├── dungeon.txt          # 副本名称列表
│   ├── job.txt              # 职业列表
│   └── server.txt           # 大区列表
├── static/                  # 静态资源文件夹
│   ├── fonts/               # 字体资源
│   ├── icons/               # 职业图标
│   └── images/              # 图像资源
├── templates/               # HTML 模板文件夹
│   ├── index.html           # 首页
│   ├── record.html          # 导随记录页面
│   ├── stats.html           # 数据统计页面
│   └── settings.html        # 用户设置页面
├── utils/                   # 工具函数文件夹
│   ├── read_info.py         # 数据读取相关
│   ├── wordcloud.py         # 词云相关
│   └── user_settings.py     # 用户设置读写相关
├── README.md   
└── requirements.txt         # 源代码运行必备 Python 库    
```

## 数据字段说明

每条导随记录包含以下信息：

- **副本（dungeon）**：副本名称
- **职业（job）**：使用的职业
- **时间（time）**：任务完成的时间
- **大区（server）**：服务器大区（考虑到 7.2 版本后国服超域传送功能开放）
- **备注（note）**

## 查询功能说明

本记录器支持在职业、大区、副本名或备注中的多关键词的包含匹配和指定关键词的全词匹配，指定关键词匹配的语法为 "指定关键词项:指定关键词"（注意中间为英文冒号）。支持的指定关键词项有：

- **职业**：请输入职业的全称
- **大区**：请输入大区的全称，不要带「区」字
- **副本名**：请输入副本的全称
- **副本类型**：迷宫挑战、行会令、讨伐歼灭战、大型任务
- **副本等级**：请输入副本等级数字，不要带「Lv.」
- **时间**：支持某一天如「2025-07-08」以及小时段如「13」
- **职能**：防护职业、治疗职业、输出职业

包含匹配和指定匹配可以单独或混合使用，各关键词之间用空格隔开，例如：

- **豆芽**：搜索职业、大区、副本名或备注中包含「豆芽」的记录
- **豆芽 副本名:最终决战天幕魔导城**：搜索职业、大区、副本名或备注中包含「豆芽」且副本名为「最终决战天幕魔导城」的记录
- **副本类型:行会令 时间:21**：搜索副本类型为「行会令」且完成时间为 21 时的记录

## 数据统计功能说明

本记录器支持以下统计图表：

- **职能分布饼图**
- **职业分布饼图**
- **大区分布饼图**
- **副本类型分布饼图**
- **主随各副本占比饼图（所有、各职能）**
- **一周/一月内每日记录数折线图**
- **各小时段记录数柱状图**

点击任意一幅统计图的某一部分都能跳转到对应的记录。
   
## 导入导出功能

本记录器提供记录的导入和导出功能：

- 导入和导出文件均为 xlsx 格式；
- 文件第一行为表头，包含「副本」、「职业」、「时间」、「大区」、「备注」列，导入时可以没有「大区」（若无该列则所有记录均会被记为可选择的默认大区）或「备注」列（若无该列则所有记录的备注均为空），导入时若存在其它列将被忽略；
- 导入时时间列的格式可为 「年月日时分秒」或者「年月日」，如「2025-07-08 11:45:14」或者「2025-07-08」。无时分秒的记录将被记为当天的 00:00:00。

以上特性使得导入时可以直接使用 [网页版导随记录器](https://dlog.luyulight.cn/) 导出的文件。

## 词云功能

本记录器提供实验性的词云生成功能，用于可视化展示所有导随记录中「备注」字段的高频词汇。

进入「导随词云」页面后，记录器会自动读取当前的词云数据；若从未生成过词云，请点击「生成/刷新词云」按钮。注意，每次添加新的记录或者更新已有的备注内容后，若想要看到最新的词云，则需要手动点击「生成/刷新词云」按钮来生成最新的词云。

## 如何运行

### 源代码运行

要以源代码形式运行本项目，您必须预先拥有 Python 环境。推荐在 Python 3.12 下运行本项目。

```bash
pip install -r ./requirements.txt
python app.py
```

随后使用任意浏览器访问 http://localhost:5000 即可使用，若端口被占用可以考虑调整 `app.py` 中的 `app.run(debug=True)` 为 `app.run(debug=True, port=<可用端口>)`。

### 可执行文件运行

TBD

## 未来规划

- [ ] 通过 Pyinstaller 打包后的，可执行文件运行的 Release 版本，可以免 Python 环境运行；
- [ ] 支持搜索时使用副本、职业、职能、大区等的别称；
- [ ] ...

## 致谢

感谢 [网页版导随记录器](https://dlog.luyulight.cn/) ，本项目在功能上与其有诸多相似之处，其中部分界面设计也参考了网页版的优秀实现。开发本项目的初衷之一，亦源于网页版导随记录器因服务器资源限制而暂不支持如记录编辑、数据导出等功能，因此希望能打造一个本地化、可控性更强的替代方案。虽然本项目受到其启发，但两者无直接关系，本地版本完全由本人开发。

---

欢迎为本项目提 Issue 或 Pull Request！

本项目仅为个人用途与爱好开发，与《最终幻想 14》官方无关。

---

**作者：小木曾雪菜 @ 伊修加德**

**License：MIT**
